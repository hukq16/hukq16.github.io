# 平滑

更新时间: January 18, 2022 3:00 PM

## 移动平均

## 指数平滑

用历史数据的线性组合预测下一时间点的值，线性组合的系数随着距离变远按负指数衰减，设衰减系数为$\omega$，计算公式可写为

$$
\hat{x}_{t} = k(\omega x_{t} + \omega^{2} x_{t-1} + ...) = k(\sum^{\infty}_{j = 0}{\omega^{j+1} x_{t-j}})
$$

考虑到加权平均的系数和应为1，则

$$
k(\sum_{j = 1}^{\infty}{\omega^{j}}) = \frac{k \omega}{1-\omega} = 1
$$

则$k=\frac{1-\omega}{\omega}$，带回原式得

$$
\begin{align*}\hat{x}_t &= (1-\omega)(x_t + \omega^2 x_{t-1} + ...) = (1-\omega)\sum^{\infty}_{j = 0}{\omega^{j} x_{t-j}}  \\ &= (1-\omega)x_t + \omega {[(1-\omega) \sum^{\infty}_{j = 0}{\omega^{j} x_{t-1-j}}]} \\ &= (1-\omega) x_t + \omega \hat{x}_{t-1} \end{align*}
$$

该方法即为指数平滑方法。早期应用中的权重$\omega$是凭借经验选取的，在之后的研究中，发现[ARIMA(0,1,1)模型](https://www.notion.so/ARIMA-fb99f61e45514da494db1f451938679b)的形式恰好为上述形式，则可以通过ARIMA建模方法估计权重$\omega$，也可用ARIMA模型的充分性检验来判断指数平滑预测是否有意义。

### 预测

### 优化

为评估指数平滑的效果，可使用平方损失函数（最小化误差平方和SSE）来估计，即估计值与实际值之差的平方和。可通过最小化SSE得到$\omega$的最佳估计。该方法涉及到非线性的最小化问题。

$$
SSE=\sum_{t=1}^{T}{(x_t - \hat{x}_{t|t-1})^2} = \sum_{t=1}^{T}{e_t^2}
$$

## 双指数平滑

当数据有趋势时，简单的指数平滑效果不佳，在这种情况下，可增加一个线性的趋势增长项$b_t$，也对$b_t$做指数平滑。为方便起见，令[指数平滑](https://www.notion.so/1e3897bf6dd84d76a92d50b404d4fa3f)中的$(1-\omega) = \alpha$,相关公式为

$$
\begin{align*} \hat{x}_t &= \alpha x_t + (1-\alpha)(\hat{x}_{t-1} + b_{t-1}) \\ b_{t} &= \beta(\hat{x}_t - \hat{x}_{t-1}) + (1-\beta)b_{t-1} \end{align*}
$$

其中，$\alpha$为数据平滑因子，$\beta$为趋势平滑因子。

由此可得出$\hat{x}_t$的梯度（增长率）为

$$
\hat{x}_t' = \alpha x_t + (1-\alpha) \hat{x}_{t-1}'
$$

## 三重指数平滑

三重指数平滑应用了三次指数平滑，这通常用于要从所研究的时间序列中去除三个高频信号的时候。一般认为第三次指数平滑可以表示季节性因子，即